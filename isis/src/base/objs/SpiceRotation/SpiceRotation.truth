Unit test for SpiceRotation
Naif code = -94031
Testing without cache ... 
CJ(0) = -0.87506927 0.25477955 -0.41151081
         0.011442263 0.86088548 0.50867009
         0.48386242 0.44041295 -0.75624969
av(0) = -1.3817139e-05 -0.0011493844 -0.00067443921
CJ(1) = -0.85216522 0.27457809 -0.44544506
         0.011408438 0.86081401 0.5087918
         0.52314843 0.42849284 -0.73668827
av(1) = -1.2759664e-05 -0.0011485667 -0.00067607282
CJ(2) = -0.82753684 0.29372914 -0.47844118
         0.011307844 0.86075918 0.50888679
         0.56129752 0.41571243 -0.71563138
av(2) = -1.4155561e-05 -0.001147111 -0.00067413283
CJ(3) = -0.80133591 0.31214822 -0.51031779
         0.011159773 0.86071999 0.50895635
         0.59811054 0.40214997 -0.69320934
av(3) = -1.2104446e-05 -0.0011411423 -0.00066849871
CJ(4) = -0.77359018 0.32985508 -0.54106734
         0.010977931 0.86068895 0.50901279
         0.63359113 0.38782749 -0.66944164
av(4) = -1.4107831e-05 -0.0011349124 -0.0006662493
CJ(5) = -0.74451309 0.34675249 -0.57049362
         0.010796958 0.86067614 0.50903832
         0.66752055 0.3728261 -0.64452852
av(5) = -1.1968844e-05 -0.0011267333 -0.00066073722
CJ(6) = -0.71415 0.36283075 -0.59861809
         0.010597655 0.86068385 0.50902947
         0.69991247 0.35717945 -0.61850252
av(6) = -8.9185184e-06 -0.0011163624 -0.00065670687
CJ(7) = -0.68276816 0.37813868 -0.625171
         0.010490873 0.86063983 0.50910611
         0.73055977 0.34104285 -0.59158448
av(7) = -1.3255742e-05 -0.0011054424 -0.00064995353
CJ(8) = -0.6504334 0.39252175 -0.65027923
         0.010371283 0.86063225 0.50912136
         0.75949248 0.32440531 -0.56385491
av(8) = -1.1327819e-05 -0.0010915537 -0.00063894876
CJ(9) = -0.61729588 0.4060182 -0.67386573
         0.010223693 0.86060645 0.50916796
         0.78666465 0.30741789 -0.53539982
av(9) = -1.2932496e-05 -0.0010747293 -0.00063276804

Testing with cache ... 
Time           = -69382819
CJ(0) = -0.87506927 0.25477955 -0.41151081
         0.011442263 0.86088548 0.50867009
         0.48386242 0.44041295 -0.75624969
av(0) = -1.3817139e-05 -0.0011493844 -0.00067443921
Time           = -69382785
CJ(1) = -0.85216522 0.27457809 -0.44544506
         0.011408438 0.86081401 0.5087918
         0.52314843 0.42849284 -0.73668827
av(1) = -1.2759664e-05 -0.0011485667 -0.00067607282
Time           = -69382751
CJ(2) = -0.82753684 0.29372914 -0.47844118
         0.011307844 0.86075918 0.50888679
         0.56129752 0.41571243 -0.71563138
av(2) = -1.4155561e-05 -0.001147111 -0.00067413283
Time           = -69382717
CJ(3) = -0.80133591 0.31214822 -0.51031779
         0.011159773 0.86071999 0.50895635
         0.59811054 0.40214997 -0.69320934
av(3) = -1.2104446e-05 -0.0011411423 -0.00066849871
Time           = -69382683
CJ(4) = -0.77359018 0.32985508 -0.54106734
         0.010977931 0.86068895 0.50901279
         0.63359113 0.38782749 -0.66944164
av(4) = -1.4107831e-05 -0.0011349124 -0.0006662493
Time           = -69382648
CJ(5) = -0.74451309 0.34675249 -0.57049362
         0.010796958 0.86067614 0.50903832
         0.66752055 0.3728261 -0.64452852
av(5) = -1.1968844e-05 -0.0011267333 -0.00066073722
Time           = -69382614
CJ(6) = -0.71415 0.36283075 -0.59861809
         0.010597655 0.86068385 0.50902947
         0.69991247 0.35717945 -0.61850252
av(6) = -8.9185184e-06 -0.0011163624 -0.00065670687
Time           = -69382580
CJ(7) = -0.68276816 0.37813868 -0.625171
         0.010490873 0.86063983 0.50910611
         0.73055977 0.34104285 -0.59158448
av(7) = -1.3255742e-05 -0.0011054424 -0.00064995353
Time           = -69382546
CJ(8) = -0.6504334 0.39252175 -0.65027923
         0.010371283 0.86063225 0.50912136
         0.75949248 0.32440531 -0.56385491
av(8) = -1.1327819e-05 -0.0010915537 -0.00063894876
Time           = -69382512
CJ(9) = -0.61729588 0.4060182 -0.67386573
         0.010223693 0.86060645 0.50916796
         0.78666465 0.30741789 -0.53539982
av(9) = -1.2932496e-05 -0.0010747293 -0.00063276804

Testing with functions ... 
Source = 3
Time           = -69382819
CJ(0) = -0.87506744 0.25462094 -0.41161286
         0.011738947 0.86135321 0.5078709
         0.48385863 0.43958939 -0.75673113
av(0) = 3.9588092e-05 -0.0011571406 -0.00066422493
Time           = -69382785
CJ(1) = -0.85215758 0.27464212 -0.44542021
         0.011286673 0.86064824 0.50907487
         0.52316352 0.42878469 -0.73650771
av(1) = 1.2612887e-05 -0.0011528552 -0.00066929916
Time           = -69382751
CJ(2) = -0.82753094 0.29389355 -0.47835042
         0.011001086 0.86036145 0.50956565
         0.56131231 0.41641897 -0.71520887
av(2) = -7.8092276e-06 -0.001146583 -0.00067221199
Time           = -69382717
CJ(3) = -0.80130119 0.31232593 -0.51026357
         0.010876467 0.86037533 0.5095449
         0.59816227 0.40274907 -0.69281678
av(3) = -2.1501533e-05 -0.0011389681 -0.00067272227
Time           = -69382683
CJ(4) = -0.77358897 0.32991801 -0.54103069
         0.010878267 0.86056939 0.50921703
         0.63359432 0.3880392 -0.66931593
av(4) = -2.8366393e-05 -0.0011306014 -0.00067058131
Time           = -69382648
CJ(5) = -0.7445192 0.34667611 -0.57053207
         0.010943787 0.86082321 0.50878643
         0.66751135 0.37255749 -0.64469335
av(5) = -2.8375445e-05 -0.0011220116 -0.00066553371
Time           = -69382614
CJ(6) = -0.71421902 0.36263313 -0.5986555
         0.010983412 0.86101859 0.50845487
         0.69983609 0.35657286 -0.6189388
av(6) = -2.1559923e-05 -0.0011136579 -0.00065731818
Time           = -69382580
CJ(7) = -0.68281661 0.37784723 -0.62529429
         0.010882256 0.86104113 0.50841887
         0.73050876 0.34035224 -0.59204502
av(7) = -8.001423e-06 -0.0011059244 -0.00064566852
Time           = -69382546
CJ(8) = -0.65044065 0.39240013 -0.65034537
         0.010502127 0.86078088 0.50886735
         0.75948448 0.324158 -0.56400791
av(8) = 1.2176658e-05 -0.0010991161 -0.00063031469
Time           = -69382512
CJ(9) = -0.61722064 0.40639527 -0.67370733
         0.0096837405 0.86013226 0.50997914
         0.78673052 0.30824564 -0.53482681
av(9) = 3.8816777e-05 -0.0010934565 -0.00061098396

Testing with polynomial functions over Spice ... 
Source = 4
Time           = -69382819
CJ(0) = -0.87809698 0.25267525 -0.40632612
         0.01085749 0.85950052 0.51101954
         0.4783595 0.44431303 -0.75746823
av(0) = 3.6136802e-05 -0.001148937 -0.0007178313
Time           = -69382785
CJ(1) = -0.85534528 0.27482047 -0.43915619
         0.013830533 0.85950782 0.51093545
         0.5178737 0.43095246 -0.73897687
av(1) = 2.6818529e-05 -0.0011482899 -0.00072824247
Time           = -69382751
CJ(2) = -0.83089148 0.29534676 -0.47158206
         0.015622985 0.85955538 0.51080376
         0.55621513 0.41705497 -0.71881144
av(2) = 1.5045992e-05 -0.0011468841 -0.00073507985
Time           = -69382717
CJ(3) = -0.80487479 0.31420086 -0.50344253
         0.016285301 0.8597142 0.5105157
         0.59322117 0.40270251 -0.69707915
av(3) = 6.7201932e-06 -0.00114088 -0.00073822293
Time           = -69382683
CJ(4) = -0.77730696 0.33143284 -0.53473934
         0.015873612 0.86003946 0.50998054
         0.62892123 0.38792318 -0.6737757
av(4) = -5.6601096e-06 -0.0011345655 -0.00074475062
Time           = -69382648
CJ(5) = -0.74837985 0.34697393 -0.56527576
         0.014476129 0.86059696 0.50908086
         0.66311239 0.37280285 -0.64907626
av(5) = -1.3898006e-05 -0.001126288 -0.00074801569
Time           = -69382614
CJ(6) = -0.71811664 0.36084246 -0.59506403
         0.012135219 0.86143483 0.50772312
         0.69581695 0.35738319 -0.62298959
av(6) = -2.1224594e-05 -0.0011158407 -0.00075276265
Time           = -69382580
CJ(7) = -0.68675883 0.37311393 -0.62381752
         0.0090314639 0.86251995 0.50594245
         0.72682924 0.34182646 -0.59571296
av(7) = -3.5938808e-05 -0.0011049021 -0.0007547869
Time           = -69382546
CJ(8) = -0.65434784 0.38366055 -0.65163908
         0.0051328027 0.86396924 0.50351842
         0.75617628 0.32613145 -0.56730566
av(8) = -4.4387854e-05 -0.0010910882 -0.00075256003
Time           = -69382512
CJ(9) = -0.62100725 0.39254656 -0.67842258
         0.00050302029 0.86574982 0.50047676
         0.78380466 0.31045844 -0.53783438
av(9) = -5.6369117e-05 -0.0010744677 -0.00075515741

Test fitting polynomial function over cache to new cache
Full cache size is 10
Minimized cache size is 10
Source = 2
Time           = -69382819
CJ(0) = -0.87809698 0.25267525 -0.40632612
         0.01085749 0.85950052 0.51101954
         0.4783595 0.44431303 -0.75746823
av(0) = 3.6136802e-05 -0.001148937 -0.0007178313
Time           = -69382785
CJ(1) = -0.85534528 0.27482047 -0.43915619
         0.013830533 0.85950782 0.51093545
         0.5178737 0.43095246 -0.73897687
av(1) = 2.6818529e-05 -0.0011482899 -0.00072824247
Time           = -69382751
CJ(2) = -0.83089148 0.29534676 -0.47158206
         0.015622985 0.85955538 0.51080376
         0.55621513 0.41705497 -0.71881144
av(2) = 1.5045992e-05 -0.0011468841 -0.00073507985
Time           = -69382717
CJ(3) = -0.80487479 0.31420086 -0.50344253
         0.016285301 0.8597142 0.5105157
         0.59322117 0.40270251 -0.69707915
av(3) = 6.7201932e-06 -0.00114088 -0.00073822293
Time           = -69382683
CJ(4) = -0.77730696 0.33143284 -0.53473934
         0.015873612 0.86003946 0.50998054
         0.62892123 0.38792318 -0.6737757
av(4) = -5.6601096e-06 -0.0011345655 -0.00074475062
Time           = -69382648
CJ(5) = -0.74837985 0.34697393 -0.56527576
         0.014476129 0.86059696 0.50908086
         0.66311239 0.37280285 -0.64907626
av(5) = -1.3898006e-05 -0.001126288 -0.00074801569
Time           = -69382614
CJ(6) = -0.71811664 0.36084246 -0.59506403
         0.012135219 0.86143483 0.50772312
         0.69581695 0.35738319 -0.62298959
av(6) = -2.1224594e-05 -0.0011158407 -0.00075276265
Time           = -69382580
CJ(7) = -0.68675883 0.37311393 -0.62381752
         0.0090314639 0.86251995 0.50594245
         0.72682924 0.34182646 -0.59571296
av(7) = -3.5938808e-05 -0.0011049021 -0.0007547869
Time           = -69382546
CJ(8) = -0.65434784 0.38366055 -0.65163908
         0.0051328027 0.86396924 0.50351842
         0.75617628 0.32613145 -0.56730566
av(8) = -4.4387854e-05 -0.0010910882 -0.00075256003
Time           = -69382512
CJ(9) = -0.62100725 0.39254656 -0.67842258
         0.00050302029 0.86574982 0.50047676
         0.78380466 0.31045844 -0.53783438
av(9) = -5.6369117e-05 -0.0010744677 -0.00075515741

Testing ToReferencePartial method
For angles (ra,dec,twist) = 1.9429654 2.1356375 -0.92665897
 For lookJ = 0.78673052 0.30824564 -0.53482681
Right ascension partial on A applied to lookJ =:  -0.50997914 -0.67370733 0
Right ascension partial on B applied to lookJ =:  -0.50997914 -0.67370733 0
Right ascension partial on C applied to lookJ =:  -0.50997914 -0.67370733 0
Declination partial on A applied to lookJ =:  -0.7977269 0.60301797 0

Twist partial on A applied to lookJ =:  0.0011693703 -0.00020943951 0

Testing with setting functions ... 
Source = 3
Time           = -69382819
CJ(0) = -0.87506744 0.25462094 -0.41161286
         0.011738947 0.86135321 0.5078709
         0.48385863 0.43958939 -0.75673113
av(0) = 3.9588092e-05 -0.0011571406 -0.00066422493
Time           = -69382785
CJ(1) = -0.85215758 0.27464212 -0.44542021
         0.011286673 0.86064824 0.50907487
         0.52316352 0.42878469 -0.73650771
av(1) = 1.2612887e-05 -0.0011528552 -0.00066929916
Time           = -69382751
CJ(2) = -0.82753094 0.29389355 -0.47835042
         0.011001086 0.86036145 0.50956565
         0.56131231 0.41641897 -0.71520887
av(2) = -7.8092276e-06 -0.001146583 -0.00067221199
Time           = -69382717
CJ(3) = -0.80130119 0.31232593 -0.51026357
         0.010876467 0.86037533 0.5095449
         0.59816227 0.40274907 -0.69281678
av(3) = -2.1501533e-05 -0.0011389681 -0.00067272227
Time           = -69382683
CJ(4) = -0.77358897 0.32991801 -0.54103069
         0.010878267 0.86056939 0.50921703
         0.63359432 0.3880392 -0.66931593
av(4) = -2.8366393e-05 -0.0011306014 -0.00067058131
Time           = -69382648
CJ(5) = -0.7445192 0.34667611 -0.57053207
         0.010943787 0.86082321 0.50878643
         0.66751135 0.37255749 -0.64469335
av(5) = -2.8375445e-05 -0.0011220116 -0.00066553371
Time           = -69382614
CJ(6) = -0.71421902 0.36263313 -0.5986555
         0.010983412 0.86101859 0.50845487
         0.69983609 0.35657286 -0.6189388
av(6) = -2.1559923e-05 -0.0011136579 -0.00065731818
Time           = -69382580
CJ(7) = -0.68281661 0.37784723 -0.62529429
         0.010882256 0.86104113 0.50841887
         0.73050876 0.34035224 -0.59204502
av(7) = -8.001423e-06 -0.0011059244 -0.00064566852
Time           = -69382546
CJ(8) = -0.65044065 0.39240013 -0.65034537
         0.010502127 0.86078088 0.50886735
         0.75948448 0.324158 -0.56400791
av(8) = 1.2176658e-05 -0.0010991161 -0.00063031469
Time           = -69382512
CJ(9) = -0.61722064 0.40639527 -0.67370733
         0.0096837405 0.86013226 0.50997914
         0.78673052 0.30824564 -0.53482681
av(9) = 3.8816777e-05 -0.0010934565 -0.00061098396

Testing line cache...
Time           = -69382819
CJ(0) = -0.87506744 0.25462094 -0.41161286
         0.011738947 0.86135321 0.5078709
         0.48385863 0.43958939 -0.75673113
av(0) = 3.9588092e-05 -0.0011571406 -0.00066422493
Time           = -69382785
CJ(1) = -0.85215758 0.27464212 -0.44542021
         0.011286673 0.86064824 0.50907487
         0.52316352 0.42878469 -0.73650771
av(1) = 1.2612887e-05 -0.0011528552 -0.00066929916
Time           = -69382751
CJ(2) = -0.82753094 0.29389355 -0.47835042
         0.011001086 0.86036145 0.50956565
         0.56131231 0.41641897 -0.71520887
av(2) = -7.8092276e-06 -0.001146583 -0.00067221199
Time           = -69382717
CJ(3) = -0.80130119 0.31232593 -0.51026357
         0.010876467 0.86037533 0.5095449
         0.59816227 0.40274907 -0.69281678
av(3) = -2.1501533e-05 -0.0011389681 -0.00067272227
Time           = -69382683
CJ(4) = -0.77358897 0.32991801 -0.54103069
         0.010878267 0.86056939 0.50921703
         0.63359432 0.3880392 -0.66931593
av(4) = -2.8366393e-05 -0.0011306014 -0.00067058131
Time           = -69382648
CJ(5) = -0.7445192 0.34667611 -0.57053207
         0.010943787 0.86082321 0.50878643
         0.66751135 0.37255749 -0.64469335
av(5) = -2.8375445e-05 -0.0011220116 -0.00066553371
Time           = -69382614
CJ(6) = -0.71421902 0.36263313 -0.5986555
         0.010983412 0.86101859 0.50845487
         0.69983609 0.35657286 -0.6189388
av(6) = -2.1559923e-05 -0.0011136579 -0.00065731818
Time           = -69382580
CJ(7) = -0.68281661 0.37784723 -0.62529429
         0.010882256 0.86104113 0.50841887
         0.73050876 0.34035224 -0.59204502
av(7) = -8.001423e-06 -0.0011059244 -0.00064566852
Time           = -69382546
CJ(8) = -0.65044065 0.39240013 -0.65034537
         0.010502127 0.86078088 0.50886735
         0.75948448 0.324158 -0.56400791
av(8) = 1.2176658e-05 -0.0010991161 -0.00063031469
Time           = -69382512
CJ(9) = -0.61722064 0.40639527 -0.67370733
         0.0096837405 0.86013226 0.50997914
         0.78673052 0.30824564 -0.53482681
av(9) = 3.8816777e-05 -0.0010934565 -0.00061098396

Testing tables ... 
Time           = -69382819
CJ(0) = -0.87506744 0.25462094 -0.41161286
         0.011738947 0.86135321 0.5078709
         0.48385863 0.43958939 -0.75673113
av(0) = 3.9588092e-05 -0.0011571406 -0.00066422493
Time           = -69382785
CJ(1) = -0.85215758 0.27464212 -0.44542021
         0.011286673 0.86064824 0.50907487
         0.52316352 0.42878469 -0.73650771
av(1) = 1.2612887e-05 -0.0011528552 -0.00066929916
Time           = -69382751
CJ(2) = -0.82753094 0.29389355 -0.47835042
         0.011001086 0.86036145 0.50956565
         0.56131231 0.41641897 -0.71520887
av(2) = -7.8092276e-06 -0.001146583 -0.00067221199
Time           = -69382717
CJ(3) = -0.80130119 0.31232593 -0.51026357
         0.010876467 0.86037533 0.5095449
         0.59816227 0.40274907 -0.69281678
av(3) = -2.1501533e-05 -0.0011389681 -0.00067272227
Time           = -69382683
CJ(4) = -0.77358897 0.32991801 -0.54103069
         0.010878267 0.86056939 0.50921703
         0.63359432 0.3880392 -0.66931593
av(4) = -2.8366393e-05 -0.0011306014 -0.00067058131
Time           = -69382648
CJ(5) = -0.7445192 0.34667611 -0.57053207
         0.010943787 0.86082321 0.50878643
         0.66751135 0.37255749 -0.64469335
av(5) = -2.8375445e-05 -0.0011220116 -0.00066553371
Time           = -69382614
CJ(6) = -0.71421902 0.36263313 -0.5986555
         0.010983412 0.86101859 0.50845487
         0.69983609 0.35657286 -0.6189388
av(6) = -2.1559923e-05 -0.0011136579 -0.00065731818
Time           = -69382580
CJ(7) = -0.68281661 0.37784723 -0.62529429
         0.010882256 0.86104113 0.50841887
         0.73050876 0.34035224 -0.59204502
av(7) = -8.001423e-06 -0.0011059244 -0.00064566852
Time           = -69382546
CJ(8) = -0.65044065 0.39240013 -0.65034537
         0.010502127 0.86078088 0.50886735
         0.75948448 0.324158 -0.56400791
av(8) = 1.2176658e-05 -0.0010991161 -0.00063031469
Time           = -69382512
CJ(9) = -0.61722064 0.40639527 -0.67370733
         0.0096837405 0.86013226 0.50997914
         0.78673052 0.30824564 -0.53482681
av(9) = 3.8816777e-05 -0.0010934565 -0.00061098396

Testing vector methods
v = 0 0 1
v = 0 0 1
Testing with linear function ... 
Source = 3
Time           = -69382819
CJ(0) = -0.87506927 0.25477955 -0.41151081
         0.011442263 0.86088548 0.50867009
         0.48386242 0.44041295 -0.75624969
Time           = -69382512
CJ(1) = -0.61729588 0.4060182 -0.67386573
         0.010223693 0.86060645 0.50916796
         0.78666465 0.30741789 -0.53539982

Testing Nadir rotation ... 
Time           = -69382819
CJ(0) = -0.87397636 0.25584047 -0.41317186
         0.011529483 0.86087973 0.50867786
         0.48583166 0.43980876 -0.75533824
Time           = -69382785
CJ(1) = -0.8510575 0.27545415 -0.44701918
         0.011395904 0.86083688 0.50875338
         0.52494883 0.42788419 -0.73576073
Time           = -69382751
CJ(2) = -0.82643964 0.29447099 -0.47987952
         0.011259757 0.86079693 0.508824
         0.56291272 0.415109 -0.71471238
Time           = -69382717
CJ(3) = -0.80023437 0.31282061 -0.5116329
         0.011120698 0.86076027 0.50888906
         0.59958426 0.4015408 -0.69228874
Time           = -69382683
CJ(4) = -0.77256675 0.3304389 -0.54217225
         0.010977542 0.86072774 0.5089472
         0.63483865 0.38724396 -0.66859704
Time           = -69382648
CJ(5) = -0.74357294 0.34727037 -0.57140403
         0.01082962 0.86070008 0.50899715
         0.66856713 0.37228842 -0.64375409
Time           = -69382614
CJ(6) = -0.71339766 0.36327069 -0.59924801
         0.010678492 0.86067708 0.50903923
         0.70067806 0.35674833 -0.6178842
Time           = -69382580
CJ(7) = -0.6821915 0.37840638 -0.62563837
         0.010527022 0.86065772 0.50907512
         0.73109776 0.34070061 -0.59111687
Time           = -69382546
CJ(8) = -0.65010809 0.39265255 -0.65052551
         0.010377232 0.86064111 0.50910626
         0.75977087 0.32422345 -0.5635844
Time           = -69382512
CJ(9) = -0.61730133 0.40599204 -0.67387649
         0.010229777 0.86062698 0.50913313
         0.78666029 0.30739495 -0.53541939

Testing angle wrapping...
   Using anchor angle of 30, 240 changes to -120
   Using anchor angle of 30, -10 changes to -10
   Using anchor angle of 30, -180 changes to 180
   Using anchor angle of 30, 90 changes to 90

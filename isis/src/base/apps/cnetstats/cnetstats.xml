<?xml version="1.0" encoding="UTF-8"?>

<application name="cnetstats" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://isis.astrogeology.usgs.gov/Schemas/Application/application.xsd">
  <brief>
    The application cnetstats has the ability to apply filters on a Control 
    Network and generate statistics into a specified output file in a specified 
    format. 
  </brief>
   
  <description> 
    <p>
    The application cnetstats has the ability to apply filters on a Control 
    Network and generate statistics into a specified output file in a specified 
    format. Application requires as input the  Control Network and its 
    corresponding Serial Number List. 
    </p>
    <p>
     Application generates Control Net Statistics like Total 
     Images, Total Points, Valid Points, Ignored Points, Ground Points, Held 
     Points, Average Error, Minimum Error Magnitude, Maximum Error Magnitude, 
     Total Measures, Valid Measures, Ignored Measures, Minimum Line Error, Minimum 
     Sample Error, Maximum Line Error, Maximum Sample Error. This is displayed in 
     PVL format in the Application Gui and also logged in the print.prt file. This 
     Statistics is generated irrespective of the options chosen. 
    </p>
    <p>
    Additional Statistics can be generated if required based on Images and/or 
    Control Points into the user specified output file. <br/>Image stats 
    provides statistics based on Images. Following are the information generated 
    by this option:
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0">
        <tr>
          <td>Filename</td><td>SerialNumber</td><td>Total Points</td>
          <td>Ignore</td><td>Ground</td><td>Held</td>
        </tr>
      </table>
   <br/>Point stats provides statistics based on Control Points. Following are 
   the information generated by this option:
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0">
        <tr>
          <td>Point Id</td><td>Type</td><td>Ignore</td><td>Held</td><td>Num 
            Measures</td><td>Ignored Measures</td>
        </tr>
      </table>
  </p>
  <p>
   cnetstats also allows the option to Filter the input ControlNet based on 
   different Filters. To apply Filters, the Filter option must be enabled and 
   the Filters in PVL format must be provided in the DEFFILE. The output file 
   must be provided to get the statistics report. Each Filter has its own 
   custom report format.<br/> The DEFFILE contains the PVL filters in the 
   following format:
   <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="5" cellspacing="0"> 
              <tr><td colspan="2"> Group = FilterName</td></tr>
              <tr><td width="10"></td><td> option = value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> 
   The DEFFILE can contain as many filters as available and the 
   application will apply the filters sequentially in the First In First Out 
   fashion. The output of the previous Filter will be the input for the next 
   Filter. The report generated will be based on the last Filter run on the 
   Control Network. It should also be noted that a particular Filter can be 
   defined only once in a DEFFILE that means it can be run only once during an 
   execution of cnetstats. If the Filter needs to be run again, the application 
   must be run again with this Filter in the DEFFILE. <br/> <br/>
   There are 2 kinds of Filters, Point Filters and Cube Filters.<br/> <br/>
   Following are the <b>Point Filters</b>: <br/>
   1. <a href="#error">ErrorMagnitude</a><br/>
   2. <a href="#id">Id</a> <br/>
   3. <a href="#measures">Measures</a><br/> 
   4. <a href="#properties">Properties</a><br/> 
   5. <a href="#latlon">Latitude Longitude Range</a><br/> 
   6. <a href="#distance">Distance</a><br/>
   7. <a href="#mproperties">Measure Properties</a><br/> 
   8. <a href="#gooodfit">Goodness Of Fit</a><br/> 
   9. <a href="#cubename">Cube Names(Serial Number)</a><br/><br/> 
    
   Following are the <b>Cube Filters</b>: <br/>
   1. <a href="#name">Name</a><br/>
   2. <a href="#numpoints">Number of Points</a> <br/>
   3. <a href="#cdistance">Measures</a><br/> <br/>
    
    <p>The Format for the output files will be in Comma Separated 
      Value(CVS). </p> <br/>
    
    1. <a name="error"><b>ErrorMagnitude</b></a> - Filter the ControlNet by 
    Control Point ErrorMagnitude. Options can be combined. To omit an option, it 
    can be deleted from the group. <br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_ErrorMagnitude</td></tr>
              <tr><td width="10"></td><td> LessThan = double value</td></tr>
              <tr><td width="10"></td><td> GreaterThan = double value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/>
    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td>Ignore</td><td> Filename</td><td>SerialNum</td><td> ErrorMagnitude</td><td>
     MeasureIgnore</td><td>Reference</td></tr> </table><br/><hr/><br/>
    
    2. <a name="id"><b>Id</b></a> - Filter by the provided Point Id Expression. 
    Wildcard '*' is allowed any number of times in the Expression.<br/>
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_IdExpression</td></tr>
              <tr><td width="10"></td><td> Expression = string value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/>

    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
    <td>NumIgnoredMeasures</td></tr> </table><br/><hr/><br/>

    3. <a name="measures"><b>Measures</b></a> - Filter by the number of 
    Measures in a Point. Options can be combined. To omit an option, it can be deleted from 
    the group. <br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_NumMeasures</td></tr>
              <tr><td width="10"></td><td> LessThan = integer value</td></tr>
              <tr><td width="10"></td><td> GreaterThan = integer value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> 

    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
     <td>NumIgnoredMeasures</td><td>Filename</td><td>SerialNum</td><td>MeasureIgnore</td><td> Reference</td>
     </tr> </table><br/><hr/><br/>

    4. <a name="properties"><b>Properties</b></a> - Filter by Point properties 
    "Ignore", "Ground", "Held". Options can be combined. To omit an option, it 
    can be set to "false" or just deleted from the group.<br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_Properties</td></tr>
              <tr><td width="10"></td><td> Ground = true/false</td></tr>
              <tr><td width="10"></td><td> Ignore = true/false</td></tr>
              <tr><td width="10"></td><td> Held = true/false</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> <br/>

    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
    <td>NumIgnoredMeasures</td></tr> </table><br/><hr/><br/>

    5. <a name="latlon"><b>Latitude Longitude Range</b></a> - Filter by Min, Max 
    Latitude and Longitude Range. Options can be combined. To omit an option, it 
    can be deleted from the group. Note that any unset value will default to 
    zero and Min Value must always be LessThanEqualTo Max Value. 
                                                        <br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_LatLon</td></tr>
              <tr><td width="10"></td><td> MinLat = double value</td></tr>
              <tr><td width="10"></td><td> MaxLat = double value</td></tr>
              <tr><td width="10"></td><td> MinLon = double value</td></tr>
              <tr><td width="10"></td><td> MaxLon = double value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> <br/>

    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
    <td>NumIgnoredMeasures</td><td>Latitude</td><td> Longitude</td><td>Radius</td></tr> 
    </table><br/><hr/><br/>

    6. <a name="distance"><b>Distance</b></a> - Filter by the specified distance 
    between the Points. All the Points which is less than the specified distance 
    will be filtered in. The units can be in pixels/meters. Default is pixels.<br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_Distance</td></tr>
              <tr><td width="10"></td><td> MaxDistance = double value</td></tr>
              <tr><td width="10"></td><td> Units = meters/pixels</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/><br/>

    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
    <td>NumIgnoredMeasures</td><td>Point#Distance >></td></tr> </table><br/><hr/><br/>

    7. <a name="mproperties"><b>Measure Properties</b></a> - Filter by Measure 
    properties like Measure Type and/or Ignore. To omit an option, it can be set 
    to "false" or just deleted from the group.  <br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_MeasureProperties</td></tr>
              <tr><td width="10"></td><td> MeasureType = All / Manual/Estimated 
                  / Auto-Registered / Manual_Validated / AutoReg_Validated</td></tr>
              <tr><td width="10"></td><td> Ignored = true/false</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> <br/>

    Report Format:<br/>
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
    <td>NumIgnoredMeasures</td><td>FileName</td><td>SerialNum</td><td>MeasureIgnore</td><td> MeasureType</td><td> 
    Reference</td></tr> </table><br/><hr/><br/>
    
    8. <a name="goodfit"><b>Goodness Of Fit</b></a> - Filter the ControlNet by 
    Control Point GoodnessOfFit. Options can be combined. To omit an option, it 
    can be deleted from the group.<br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_GoodnessOfFit</td></tr>
              <tr><td width="10"></td><td> LessThan = double value</td></tr>
              <tr><td width="10"></td><td> GreaterThan = double value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> <br/>
    
    Report Format:<br/> 
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td>Ignore</td><td>Filename</td><td>SerialNum</td>
    <td>GoodnessOfFit</td><td>MeasureIgnore</td><td>Reference</td></tr> </table><br/>  <hr/><br/>

    9. <a name="cubename"><b>Cube Names(Serial Number)</b></a> - Filter the 
    ControlNet by Cube Serial Number. Only Points with the specified Image as 
    one of their Measures will be Filtered in. Any number of Cube names can be 
    entered with "Cube="  <br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Point_CubeNames</td></tr>
              <tr><td width="10"></td><td> Cube = Cube Name</td></tr>
              <tr><td width="10"></td><td> Cube = Cube Name</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/><br/> 
    
    Report Format:<br/> 
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>PointID</td><td>Type</td><td> Ignore</td><td>Held</td><td>NumMeasures</td>
    <td>NumIgnoredMeasures</td><td>FileName</td><td>SerialNum</td><td>Total Points</td>
    <td>Ignore</td><td>Ground</td><td>Held</td></tr></table><br/>  <hr/><br/>

    Following are the <b>Cube Filters</b>: <br/>
    1. <a name="name"><b>Name</b></a> - Filter by the provided Cube Serial 
    Number Expression. Wildcard '*' is allowed any number of times in the 
    Expression. <br/>
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Cube_NameExpression</td></tr>
              <tr><td width="10"></td><td> Expression = string value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/><br/>

    Report Format:<br/> 
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>FileName</td><td>SerialNum</td><td>Total Points</td>
    <td>Ignore</td><td>Ground</td><td>Held</td></tr></table><br/>  <hr/><br/>
    
    2. <a name="numpoints"><b>Number of Points</b></a> - Filter the ControlNet by 
    the number of Control Points in each image. Options can be combined. To omit 
    an option, it can be deleted from the group.<br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Cube_NumPoints</td></tr>
              <tr><td width="10"></td><td> LessThan = integer value</td></tr>
              <tr><td width="10"></td><td> GreaterThan = integer value</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/><br/>

    Report Format:<br/> 
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>FileName</td><td>SerialNum</td><td>Total Points</td>
    <td>Ignore</td><td>Ground</td><td>Held</td></tr></table><br/>  <hr/><br/>

    3. <a name="cdistance"><b>Distance</b></a> - Filter by the specified 
    distance between the Points. All the Images which have Points which are less than the 
    specified distance between them will be filtered in. The units can be in 
    pixels/meters.  Default is pixels. <br/> 
    <table border="1" cellpadding="2" cellspacing="0" bgcolor="#f0f0f0">
     <tr><td><table border="0" cellpadding="3" cellspacing="0"> 
              <tr><td colspan="2"> Group = Cube_Distance</td></tr>
              <tr><td width="10"></td><td> MaxDistance = double value</td></tr>
              <tr><td width="10"></td><td> Units = meters/pixels</td></tr>
              <tr><td colspan="2"> EndGroup</td></tr> </table> 
    </td></tr> </table><br/> <br/>

    Report Format:<br/> 
    <table border="1" cellpadding="10" cellspacing="0" bgcolor="#f0f0f0"> 
    <tr><td>FileName</td><td>SerialNum</td><td>Total Points</td>
    <td>Ignore</td><td>Ground</td><td>Held</td>
    <td>Distance_PointIDs >> </td></tr></table><br/><br/> </p> 
    </description> 

  <category>
    <categoryItem>Control Networks</categoryItem>
  </category>

  <history>
    <change name="Sharmila Prasad" date="2010-08-04"> Original version</change>
    <change name="Sharmila Prasad" date="2010-09-17"> Removed unused 
      Format group and modified to verify the input before the actual stats 
      processing</change>
    <change name="Sharmila Prasad" date="2010-09-27">Validate DefFile 
      comparing with the Template. Record the DefFile in the Log</change>
    <change name="Sharmila Prasad" date="2010-10-13">Use only one copy 
      of Control Net</change>
  </history>
      
  <groups>
    <group name="Input">
      <parameter name="FROMLIST">
        <type>filename</type>
        <fileMode>input</fileMode>
        <brief>List of Input cubes in the control network</brief>
        <description>
          Use this parameter to specify the cube filenames which are associated with
          the control network.
        </description>
        <filter>*.lis</filter>
      </parameter>

      <parameter name="CNET">
        <type>filename</type>
        <fileMode>input</fileMode>
        <brief>Input control network</brief>
        <description>
          This file must contain control network with valid points and 
          measurements
        </description>
        <filter>*.net</filter>
      </parameter> 
    </group>

    <group name="Filter">
      <parameter name="FILTER">
        <type>boolean</type>
        <internalDefault>false</internalDefault>
        <brief>Apply filters on the Control Network</brief> 
        <description>Apply filters on the Control Network defined in the 
          DEFFILE. The resulting stats are logged in the Output FLATFILE.
        </description>
        <inclusions>
          <item>DEFFILE</item>
          <item>FLATFILE</item>
        </inclusions>
        </parameter> 
      <parameter name="DEFFILE">
        <type>filename</type>
        <fileMode>input</fileMode>
        <internalDefault>None</internalDefault>
        <brief>Input Filter Definition file</brief>
        <description>
         This file contains the filters to be run on the Control Network for 
         which the statistics is generated and printed onto the Output file
        </description>
        <filter>*.def</filter> 
      </parameter> 
      <parameter name="FLATFILE">
        <type>filename</type>
        <fileMode>output</fileMode>
        <internalDefault>None</internalDefault>
        <brief>Output Flat File</brief>
        <description>
          This file will contain statistics in the csv format for the 
          selected options
        </description>
      </parameter>
    </group>

    <group name="Statistics">
      <parameter name="CREATE_IMAGE_STATS">
        <type>boolean</type>
        <internalDefault>false</internalDefault>
        <brief>Generates stats of all the Images in the Control Network</brief>
        <description>When Enabled, generates the statistics of all the Images
          wrt the Control Network into the Image Stats File. Stores info such as 
          the total points in each Image, total ignored and point types. 
        </description>
        <inclusions><item>IMAGE_STATS_FILE</item></inclusions>
      </parameter>

      <parameter name="IMAGE_STATS_FILE">
        <type>filename</type>
        <fileMode>output</fileMode>
        <internalDefault>None</internalDefault>
        <brief>Generates stats of all the Images in the Control Network</brief>
        <description>This file will contain statistics of all the Images
          wrt the Control Network. Stores info such as the filename, serial 
          number, total points in each Image, total ignored and point types. 
        </description>
      </parameter>
    
      <parameter name="CREATE_POINT_STATS">
        <type>boolean</type>
        <internalDefault>false</internalDefault>
        <brief>Generates stats of all the Points in the Control Network</brief> 
        <description>When Enabled, generates the statistics of all the Points in 
        the Control Network into the Point Stats File. Stores info such as the 
        point Id, type, ignore flag, number of measures, number of ignored 
        measures, measure held flag.
        </description>
        <inclusions><item>POINT_STATS_FILE</item></inclusions>
      </parameter>

      <parameter name="POINT_STATS_FILE">
        <type>filename</type>
        <fileMode>output</fileMode>
        <internalDefault>None</internalDefault>
        <brief>Contains statistics of all the Points in the Control 
          Network</brief>
        <description>When Enabled, generates the statistics of all the Points in 
        the Control Network into the Point Stats File. Stores info such as the 
        point Id, type, ignore flag, number of measures, number of ignored 
        measures, measure held flag.
        </description>
      </parameter>
    </group>
  </groups>
</application>

